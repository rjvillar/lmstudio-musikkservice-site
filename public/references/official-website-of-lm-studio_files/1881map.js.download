"use strict";!function(t){var e={lat:59.9139,lon:10.7522,lookup:"Oslo, Oslo, Norway"},a=function(e,a){var n={frameheight:400,zoom:10};this.el=e,this.$element=t(e),this.options=t.extend({},n,a),this.init()};a.prototype={init:function(){var t=this;window._monoLoader.utils.waitFor(function(){return window.DM1881},function(){t.getModuleAddress(function(e){var a=t.options.address.replace(/\s+/g,""),n=e[a]&&e[a].hasOwnProperty("lat")?e[a].lat:!1,o=e[a]&&e[a].hasOwnProperty("lon")?e[a].lon:!1;t.renderMap(n,o)})},7e3,50)},reinit:function(){var t=this;this.options={address:this.$element.attr("data-address")&&this.$element.attr("data-address").length>0?this.$element.attr("data-address").trim():e.lookup,frameheight:this.$element.attr("data-frameheight")?parseInt(this.$element.attr("data-frameheight")):400,zoom:this.$element.attr("data-zoom")?parseInt(this.$element.attr("data-zoom")):10},this.$element.empty(),this.getModuleAddress(function(e){var a=t.options.address.replace(/\s+/g,""),n=e[a]&&e[a].hasOwnProperty("lat")?e[a].lat:!1,o=e[a]&&e[a].hasOwnProperty("lon")?e[a].lon:!1;t.renderMap(n,o)})},renderMap:function(t,a){var n=this;t&&a||(t=e.lat,a=e.lon,console.warn("Address set to default: "+e.lookup));var o={iconUrl:"https://www.1881.no/Widget/Resource/Images/map-marker-blue.png",markerLat:t,markerLon:a,frameHeight:this.options.frameheight,zoomlevel:this.options.zoom},r=new DM1881.XMap(t,a,o);r.renderTo(this.$element.attr("id"));var i=setInterval(function(){n.$element.height()>0&&("function"==typeof n.options.onRender&&n.options.onRender(),clearInterval(i))},200)},getModuleAddress:function(e){var a=this.$element;t.ajax({type:"GET",url:a.attr("data-url"),data:t.param({getGeometry:!0,mch:!0}),success:function(t){"function"==typeof e&&e(t)}})}},t.fn.mono1881=function(e){return this.each(function(){t.data(this,"mono1881")||t.data(this,"mono1881",new a(this,e))})}}(jQuery),window._mono1881={init:function(){$(".module.m1881").each(function(t,e){if($(e).data("map1881"))return!0;var a={};$(e).attr("data-address")&&$(e).attr("data-address").trim().length>0&&(a.address=$(e).attr("data-address").trim()),$(e).attr("data-zoom")&&(a.zoom=parseInt($(e).attr("data-zoom"))),$(e).attr("data-frameheight")&&(a.frameheight=parseInt($(e).attr("data-frameheight"))),document.body.hasAttribute("data-istool")&&window.parent.iframeGrids&&(a.onRender=function(){window.parent.iframeGrids.remakeGridsStyle()}),$(e).mono1881(a)})}},window._mono1881.init();